<!DOCTYPE html>
<html lang = "en">
	<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Bootstrap CSS -->
    <link href="https://bootswatch.com/4/slate/bootstrap.min.css" rel="stylesheet">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <link rel="icon" href="https://vignette1.wikia.nocookie.net/harrypotter/images/2/23/Hallows.png/revision/latest?cb=20090309113642">		
    <title>1v1</title>
  </head>
  <body>
    <div class="container">
      <center>
        <br/>
        <!-- <h1>
          1v1
        </h1> -->
      </center>
      <br/>
      <center>
      <table class="table table-bordered table-dark">
        <thead>
          <tr>
            <th scope="col"></th>
            <th scope="col">Colan</th>
            <th scope="col">Eisner</th>
            <th scope="col">PM</th>
            <th scope="col">PW</th>
            <th scope="col">Tito</th>
            <th scope="col">Bruce</th>
            <th scope="col">Win %</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th scope="row">Colan</th>
            <td id="cc">0/0</td> <!--colan-->
            <td id="ce">0/0</td> <!--Eisner-->
            <td id="cm">2/2</td> <!--PM-->
            <td id="cw">0/0</td> <!--PW-->
            <td id="ct">0/1</td> <!--Tito-->
            <td id="cb">0/1</td> <!--Bruce-->
            <td id="ctotal">2/4</td> <!--Total-->
          </tr>
          <tr>
            <th scope="row">Eisner</th>
            <td id="ec">0/0</td> <!--colan-->
            <td id="ee">0/0</td> <!--Eisner-->
            <td id="em">0/1</td> <!--PM-->
            <td id="ew">0/1</td> <!--PW-->
            <td id="et">0/1</td> <!--Tito-->
            <td id="eb">0/0</td> <!--Bruce-->
            <td id="etotal">0/3</td> <!--Total-->
          </tr>
          <tr>
            <th scope="row">PM</th>
            <td id="mc">0/2</td> <!--colan-->
            <td id="me">1/1</td> <!--Eisner-->
            <td id="mm">0/0</td> <!--PM-->
            <td id="mw">0/0</td> <!--PW-->
            <td id="mt">0/0</td> <!--Tito-->
            <td id="mb">0/1</td> <!--Bruce-->
            <td id="mtotal">1/4</td> <!--Total-->
          </tr>
          <tr>
            <th scope="row">PW</th>
            <td id="wc">0/0</td> <!--colan-->
            <td id="we">1/1</td> <!--Eisner-->
            <td id="wm">0/0</td> <!--PM-->
            <td id="ww">0/0</td> <!--PW-->
            <td id="wt">0/1</td> <!--Tito-->
            <td id="wb">1/1</td> <!--Bruce-->
            <td id="wtotal" >2/3</td> <!--Total-->
          </tr>
          <tr>
            <th scope="row">Tito</th>
            <td id="tc">1/1</td> <!--colan-->
            <td id="te">1/1</td> <!--Eisner-->
            <td id="tm">0/0</td> <!--PM-->
            <td id="tw">1/1</td> <!--PW-->
            <td id="tt">0/0</td> <!--Tito-->
            <td id="tb">0/0</td> <!--Bruce-->
            <td id="ttotal">3/3</td> <!--Total-->
          </tr>
          <tr>
            <th scope="row">Bruce</th>
            <td id="bc">1/1</td> <!--colan-->
            <td id="be">0/0</td> <!--Eisner-->
            <td id="bm">1/1</td> <!--PM-->
            <td id="bw">0/1</td> <!--PW-->
            <td id="bt">0/0</td> <!--Tito-->
            <td id="bb">0/0</td> <!--Bruce-->
            <td id="btotal">2/3</td> <!--Total-->
          </tr>
        </tbody>
      </table>
    </center>
  <br/>
    
      
    <div class="row">
      <div class="col-sm">
        <center>
          <h3>
            Matches of the Hour
          </h3>

          <br/>
          <p id="hr0"></p>
          <p id="hr1"></p>
          <p id="hr2"></p>
        </center>
      </div>
      <div class="col-sm">
        <center>
          <h3>
            Uncommon Matches
          </h3>
          <br/>
          <p id="lsm0"></p>
          <p id="lsm1"></p>
          <p id="lsm2"></p>
        </center>
      </div>
      <div class="col-sm">
        <center>
          <button type="button" class="btn btn-outline-success" id="generate">
            Random Matches
          </button>
          <br/>
          <br/>
          <p id="0"></p>
          <p id="1"></p>
          <p id="2"></p>
        </center>
      </div>
    </div>

    
    </div>


    <script type="text/javascript" src="mersenne-twister.js"></script>
    <script>
      let players = ['c', 'e', 'm', 'w', 't', 'b'];
      const matrix = [
      // c  e  m  w  t  b
        [0, 0, 2, 0, 0, 0], // colan
        [0, 0, 0, 0, 0, 0], // eisner
        [0, 1, 0, 0, 0, 0], // pm
        [0, 1, 0, 0, 0, 1], // pw
        [1, 1, 0, 1, 0, 0], // tito
        [1, 0, 1, 0, 0, 0], // bruce
      ];

      // populate matrix with wins and losses for players
      for(var i = 0; i < players.length; ++i) {
        var wins = 0;
        var total = 0;
        for(var j = 0; j < players.length; ++j) {
          wins += matrix[i][j];
          total += matrix[i][j] + matrix[j][i];
          $(`#${players[i]}${players[j]}`).text(`${matrix[i][j]} / ${matrix[i][j] + matrix[j][i]}`);
        }
        
        $(`#${players[i]}total`).text((wins/total).toFixed(2));
      }

      // populate least played matches


      // https://stackoverflow.com/questions/2450954/how-to-randomize-shuffle-a-javascript-array?rq=1
      const shuffle = (array, random) => {
        var currentIndex = array.length, temporaryValue, randomIndex;

        // While there remain elements to shuffle...
        while (0 !== currentIndex) {

          // Pick a remaining element...
          randomIndex = Math.floor(random.random() * currentIndex);
          // randomIndex = Math.floor(Math.random() * currentIndex);
          currentIndex -= 1;

          // And swap it with the current element.
          temporaryValue = array[currentIndex];
          array[currentIndex] = array[randomIndex];
          array[randomIndex] = temporaryValue;
        }

        return array;
      }

      const generateMatches = (prefix, seed) => {
        const random = new MersenneTwister(seed);

        if(seed !== undefined) {
          random.init_seed(seed);
        }

        let people = ['colan', 'pm', 'pw', 'tito', 'bruce', 'eisner'];
        people = shuffle(people, random);
        
        for(let i = 0; i <= 3; ++i) {
          // people = shuffle(people);
          let person1 = people.pop()
          let person2 = people.pop();

          $(`#${prefix}${i}`).text(`${person1} vs. ${person2}`);
        }
      };

      $('#generate').click(() =>{
        generateMatches('', undefined);
      });

      // match of the hour
      const date = new Date().toLocaleString("en-US", {timeZone: "America/New_York"});
      const splitDate = date.split(', ');

      const dateStringSplit = splitDate[0].split('/');
      const month = dateStringSplit[0];
      const day = dateStringSplit[1];
      const year = dateStringSplit[2];
      const hour = splitDate[1].split(':')[0];
      const seed = `${year}${month}${day}${hour}`;

      generateMatches('hr', seed);
    </script>
  </body>
</html>